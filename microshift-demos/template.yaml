  image: {{ image }}
{% if rhnregister %}
  rhnregister: true
{% endif %}
{% if rhnorg %}
  rhnorg: {{ rhnorg }}
{% endif %}
{% if rhnactivationkey %}
  rhnactivationkey: {{ rhnactivationkey }}
{% endif %}
  numcpus: {{ numcpus }}
  memory: {{ memory }}
  disks:
    - size: {{ disk_size }}
  {% if reservedns %}
  reservedns: true
  {% endif %}
  nets:
    - name: {{ net_name }}
  cmds:
    - echo {{ user_password }} | passwd --stdin root
    - useradd {{ user }}
    - usermod -aG wheel {{ user }}
    - echo "{{ user }} ALL=(root) NOPASSWD:ALL" | tee -a /etc/sudoers.d/{{ user }}
    - echo {{ user_password }} | passwd --stdin {{ user }}
    - subscription-manager refresh
    - subscription-manager attach --auto
    - dnf install git vim unzip wget tar python3 python3-pip util-linux-user tmux -y 
    - cd /root/ && git clone https://github.com/redhat-et/microshift-demos.git
{% if offline_token %}
    - export OFFLINE_TOKEN={{ offline_token }}
    - echo $OFFLINE_TOKEN > /root/offline_token
    - echo $OFFLINE_TOKEN > {{ user }}/offline_token
{% endif %}
{% if openshift_pull_secret %}
    - export PULL_SECRET={{ openshift_pull_secret }}
    - echo $PULL_SECRET > /root/.pull-secret.json
    - echo $PULL_SECRET > {{ user }}/.pull-secret.json
{% endif %}
